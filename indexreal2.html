<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f4f7f9;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .container {
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            max-width: 800px;
            width: 100%;
            margin: 20px;
            padding: 40px;
            box-sizing: border-box;
        }
        .profile-header {
            display: flex;
            align-items: center;
            border-bottom: 1px solid #eeeeee;
            padding-bottom: 20px;
            margin-bottom: 20px;
        }
        .profile-header img {
            border-radius: 50%;
            width: 120px;
            height: 120px;
            object-fit: cover;
            margin-right: 20px;
        }
        .profile-header h1 {
            margin: 0;
            font-size: 28px;
            color: #333333;
        }
        .profile-header p {
            margin: 5px 0;
            color: #666666;
        }
        .profile-details {
            margin-bottom: 20px;
        }
        .profile-details label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333333;
        }
        .profile-details p {
            margin: 0;
            color: #444444;
        }
        .profile-actions {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .profile-actions button {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            border-radius: 5px;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .profile-actions button:hover {
            background-color: #0056b3;
        }
        .home-button {
            background-color: #28a745;
        }
        .home-button:hover {
            background-color: #1e7e34;
        }
        .intro-section {
            margin-bottom: 30px;
        }
        .intro-section h2 {
            font-size: 22px;
            color: #333333;
            margin-bottom: 10px;
        }
        .intro-section p {
            font-size: 16px;
            color: #555555;
            line-height: 1.5;
        }
        .divider {
            border-top: 1px solid #eeeeee;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="profile-header">
            <img id="profileImage" src="default-profile.png" alt="Profile Photo">
            <div>
                <h1 id="profileName">Loading...</h1>
                <p id="profileAddress">Loading...</p>
                <p id="profileDob">Loading...</p>
                <p id="profileBio">Loading...</p>
            </div>
        </div>

        <div class="intro-section">
            <h2>Welcome to Your Profile</h2>
            <p>Here you can view and manage your personal details. Make sure your information is up to date to fully benefit from our online courses. Update your profile as needed and check out the various courses and resources available to enhance your learning experience.</p>
        </div>

        <div class="divider"></div>

        <div class="profile-actions">
            <button class="logout-button" id="logoutButton">Logout</button>
            <button class="home-button" id="homeButton">Home</button>
        </div>
    </div>

    <!-- Import Firebase SDKs and JavaScript -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-analytics.js";
        import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
        import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD7jn56HDd6nME3dommemdPJHFaKHpjuhY",
            authDomain: "prosper-a9810.firebaseapp.com",
            projectId: "prosper-a9810",
            storageBucket: "prosper-a9810.appspot.com",
            messagingSenderId: "1040350127188",
            appId: "1:1040350127188:web:da8987386085d778eaf9cl1",
            measurementId: "G-6G8BMD6S3G"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const firestore = getFirestore(app);
        const storage = getStorage(app);

        async function fetchUserData(userId) {
            const docRef = doc(firestore, 'users', userId);
            const docSnap = await getDoc(docRef);

            if (docSnap.exists()) {
                const userData = docSnap.data();
                document.getElementById('profileName').textContent = userData.name;
                document.getElementById('profileAddress').textContent = userData.address;
                document.getElementById('profileDob').textContent = userData.dob;
                document.getElementById('profileBio').textContent = userData.bio;
                
                if (userData.photoURL) {
                    const img = document.getElementById('profileImage');
                    img.src = userData.photoURL;
                }
            } else {
                alert("No user data found.");
            }
        }

        onAuthStateChanged(auth, (user) => {
            if (user) {
                fetchUserData(user.uid);
            } else {
                window.location.href = 'login.html';
            }
        });

        document.getElementById('logoutButton').addEventListener('click', () => {
            signOut(auth).then(() => {
                window.location.href = 'login.html';
            }).catch((error) => {
                alert(error.message);
            });
        });

        document.getElementById('homeButton').addEventListener('click', () => {
            window.location.href = 'indexreal.html';
        });
    </script>
</body>
</html>
