 
<!DOCTYPE html> 
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="style.css">
    <title>Music App</title>
</head>

<body>
<header>
    <div class="menu_side">
        <h1>Playlist</h1>
        <div class="playlist">
            <h4 class="active"><span></span><i class="bi bi-music-note-beamed"></i> Playlist</h4>
            <h4 ><span></span><i class="bi bi-music-note-beamed"></i> Last Listening</h4>
            <h4 ><span></span><i class="bi bi-music-note-beamed"></i> Recommended</h4>
        </div>
        <div class="menu_song" id="menuSong">
            <!-- Songs will be dynamically inserted here -->
        </div>
    </div>
    
    <div class="popular_artists">
        <div class="h4">
            <h4>Popular Artists</h4>
            <div class="btn_s">
                <i id="left_scrolls" class="bi bi-arrow-left-short"></i>
                <i id="right_scrolls" class="bi bi-arrow-right-short"></i>
            </div>
        </div>
        <div class="item" id="popularArtists">
            <!-- Artist images will be dynamically inserted here -->
        </div>
    </div>
</header>

<!-- Import Firebase SDKs -->
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyD7jn56HDd6nME3dommemdPJHFaKHpjuhY",
        authDomain: "prosper-a9810.firebaseapp.com",
        projectId: "prosper-a9810",
        storageBucket: "prosper-a9810.appspot.com",
        messagingSenderId: "1040350127188",
        appId: "1:1040350127188:web:da8987386085d778eaf9cl1",
        measurementId: "G-6G8BMD6S3G"
    };

    const app = initializeApp(firebaseConfig);
    const firestore = getFirestore(app);

    const popularArtistsContainer = document.getElementById('popularArtists');
    const menuSong = document.getElementById('menuSong');
    const radioAudio = new Audio(); // Audio object for playing songs

    async function loadPopularArtists() {
        try {
            const querySnapshot = await getDocs(collection(firestore, 'songs'));
            const artists = new Set();
            querySnapshot.forEach((doc) => {
                const songData = doc.data();
                artists.add({ name: songData.artist, image: songData.coverURL });
            });

            artists.forEach(artist => {
                const artistItem = document.createElement('li');
                const artistImage = document.createElement('img');
                artistImage.src = artist.image; // Use artist image from Firestore
                artistImage.alt = artist.name;
                artistImage.title = artist.name;
                artistImage.style.cursor = "pointer"; // Make it clear it's clickable

                artistImage.addEventListener('click', () => {
                    displaySongsByArtist(artist.name);
                });

                artistItem.appendChild(artistImage);
                popularArtistsContainer.appendChild(artistItem);
            });
        } catch (error) {
            console.error("Error loading popular artists: ", error);
        }
    }

    async function displaySongsByArtist(artist) {
        menuSong.innerHTML = ""; // Clear current song list
        const querySnapshot = await getDocs(collection(firestore, 'songs'));

        querySnapshot.forEach((doc) => {
            const songData = doc.data();
            if (songData.artist === artist) {
                const songItem = document.createElement('li');
                songItem.className = "songItem";
                songItem.innerHTML = `
                    <span>${songData.index}</span>
                    <img src="${songData.coverURL}" alt="${songData.title}">
                    <h5>
                        ${songData.title}
                        <div class="subtitle">${songData.artist}</div>
                    </h5>
                    <i class="bi playListPlay bi-play-circle-fill" onclick="playSong('${songData.audioURL}')"></i>
                `;
                menuSong.appendChild(songItem);
            }
        });
    }

    function playSong(audioURL) {
        radioAudio.src = audioURL;
        radioAudio.play();
    }

    // Load popular artists on page load
    window.onload = () => {
        loadPopularArtists();
    };
</script>

</body>
</html>


